// Generated by CoffeeScript 1.10.0
(function() {
  var bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  this.Game = (function() {
    Game.dns = {
      "moogle.com": "256.241.23.02"
    };

    Game.prototype.apps = {};

    Game.prototype.servers = {
      "local": new Server("local", "456.231.24.57", [new Directory("home", [new Directory("a", [new TextFile("test", "coucou")]), new Directory("b")]), new TextFile("a", "hi!")]),
      "moogle": new Server("moogle.com", "256.241.23.02", [new Directory("etc"), new Directory("home", [new Directory("john")]), new Directory("var")], [
        new DatabaseSim([
          new Table("user_table", {
            0: new Google.User(0, "john", "dd6x5few961few68fq4wd6", "California")
          })
        ])
      ])
    };

    function Game(srcPath) {
      this.srcPath = srcPath;
      this.triggerEvent = bind(this.triggerEvent, this);
      this.getEvent = bind(this.getEvent, this);
      this.loadLocale = bind(this.loadLocale, this);
      this.loadData = bind(this.loadData, this);
      this.initModules = bind(this.initModules, this);
      this.loadModules = bind(this.loadModules, this);
      this.audioPath = this.srcPath + 'audio/';
    }

    Game.prototype.loadModules = function() {
      var modulePath;
      modulePath = game.srcPath + "modules/";
      return $.when($.get(modulePath + "hub.html"), $.get(modulePath + "phone.html"), $.get(modulePath + "terminal.html")).done(function(arg, arg1, arg2) {
        var hubHTML, phoneHTML, terminalHTML;
        hubHTML = arg[0];
        phoneHTML = arg1[0];
        terminalHTML = arg2[0];
        console.log("[LOAD] Loaded Hub, Phone, Terminal HTML");
        $("#content").html(hubHTML);
        $("#phoneContent").html(phoneHTML);
        return $("#terminalContent").html(terminalHTML);
      });
    };

    Game.prototype.initModules = function() {
      if (typeof game === "undefined" || game === null) {
        throw new Error("document.game has not been defined, please create a game instance with @game = new Game first.");
      }
      this.hub = new Hub;
      this.terminal = this.apps['terminal'] = new Terminal($("#terminal-screen"), $("#terminal-device"));
      this.phone = this.apps['phone'] = new Phone($("#phone-screen"), $("#phone-device"));
      this.apps['chat'] = new App(null, null);
      this.apps['memo'] = new App(null, null);
      this.apps['other'] = new App(null, null);
      this.apps['news'] = new App(null, null);
      this.apps['camera'] = new App(null, null);
      return this.story = new Story;
    };

    Game.prototype.loadData = function(dialogueFilename) {
      this.data = new GameData;
      return this.data.loadDialogueGraphs(game.srcPath + dialogueFilename);
    };

    Game.prototype.loadLocale = function(dialoguesFilename) {
      this.locale = new Localize;
      return this.locale.loadDialogueLines(game.srcPath + dialoguesFilename);
    };

    Game.prototype.getEvent = function(name) {
      return this.data.eventFunctions[name];
    };

    Game.prototype.triggerEvent = function(name) {
      return this.data.eventFunctions[name]();
    };

    return Game;

  })();

}).call(this);

//# sourceMappingURL=game.js.map
